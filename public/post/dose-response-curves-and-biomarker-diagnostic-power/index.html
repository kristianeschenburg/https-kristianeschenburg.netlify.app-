<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="The other day, one of my friends and colleagues (I&rsquo;ll refer to him as &ldquo;Dr. A&rdquo;) asked me if I knew anything about assessing biomarker diagnostic power. He went on to describe his clinical problem, which I&rsquo;ll try to recant here (but will likely mess up some of the relevant detail &ndash; his research pertains to generating induced pluripotent cardiac stem cells, which I have little to no experience with):">

  
  <link rel="alternate" hreflang="en-us" href="/post/dose-response-curves-and-biomarker-diagnostic-power/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186337108-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186337108-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hue3d34eb7f27f0837dcea880d4d221db4_377404_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hue3d34eb7f27f0837dcea880d4d221db4_377404_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="/post/dose-response-curves-and-biomarker-diagnostic-power/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="A Rambling On">
  <meta property="og:url" content="/post/dose-response-curves-and-biomarker-diagnostic-power/">
  <meta property="og:title" content="Dose-Response Curves and Biomarker Diagnostic Power | A Rambling On">
  <meta property="og:description" content="The other day, one of my friends and colleagues (I&rsquo;ll refer to him as &ldquo;Dr. A&rdquo;) asked me if I knew anything about assessing biomarker diagnostic power. He went on to describe his clinical problem, which I&rsquo;ll try to recant here (but will likely mess up some of the relevant detail &ndash; his research pertains to generating induced pluripotent cardiac stem cells, which I have little to no experience with):"><meta property="og:image" content="/img/Bayes.jpg">
  <meta property="twitter:image" content="/img/Bayes.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-27T11:12:32-07:00">
    
    <meta property="article:modified_time" content="2019-08-28T11:12:32-07:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/dose-response-curves-and-biomarker-diagnostic-power/"
  },
  "headline": "Dose-Response Curves and Biomarker Diagnostic Power",
  
  "datePublished": "2019-08-27T11:12:32-07:00",
  "dateModified": "2019-08-28T11:12:32-07:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "A Rambling On",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hue3d34eb7f27f0837dcea880d4d221db4_377404_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "The other day, one of my friends and colleagues (I\u0026rsquo;ll refer to him as \u0026ldquo;Dr. A\u0026rdquo;) asked me if I knew anything about assessing biomarker diagnostic power. He went on to describe his clinical problem, which I\u0026rsquo;ll try to recant here (but will likely mess up some of the relevant detail \u0026ndash; his research pertains to generating induced pluripotent cardiac stem cells, which I have little to no experience with):"
}
</script>

  

  


  


  





  <title>Dose-Response Curves and Biomarker Diagnostic Power | A Rambling On</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">A Rambling On</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">A Rambling On</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/personal"><span>Personal</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Resume.pdf"><span>Resume</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Dose-Response Curves and Biomarker Diagnostic Power</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Aug 28, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>The other day, one of my friends and colleagues (I&rsquo;ll refer to him as &ldquo;Dr. A&rdquo;) asked me if I knew anything about assessing biomarker diagnostic power.  He went on to describe his clinical problem, which I&rsquo;ll try to recant here (but will likely mess up some of the relevant detail &ndash; his research pertains to generating induced pluripotent cardiac stem cells, which I have little to no experience with):</p>
<blockquote>
<p>&ldquo;So chemotherapy is meant to combat cancer.  But some clinicians, and their patients, have found that some forms of chemotherapy and anti-cancer drugs later result in problems with the heart and vasculature &ndash; these problems are collectively referred to as &lsquo;cardiotoxicity&rsquo;.</p>
</blockquote>
<blockquote>
<p>We&rsquo;re interested in developing biomarkers that will help us identify which patients might be susceptible to cardiotoxicity, and in assessing the predictive power of these biomarkers.  Can you help me?&rdquo;</p>
</blockquote>
<p>What follows will be my exploration into what Dr. A called 
<a href="https://en.wikipedia.org/wiki/Dose%E2%80%93response_relationship" target="_blank" rel="noopener">dose-response curves</a>, and my approach on how to use these curves to assess biomarker diagnostic power.  I&rsquo;ll do a walk through of some Python code that I&rsquo;ve written up, where I&rsquo;ll examine dose-response curves and their diagnostic power using the <strong>receiver operating characteristic</strong> (
<a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" target="_blank" rel="noopener">ROC</a>) and the closely related <strong>area under the curve</strong> (
<a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve" target="_blank" rel="noopener">AUC</a>) metrics.</p>
<p>If you want to see the actual dose-response curve analysis, skip to the <strong>Analyzing Synthetic Dose-Response Curves</strong> section down below.</p>
<h3 id="brief-introduction-to-the-roc-and-auc">Brief Introduction to the ROC and AUC</h3>
<p>I first wanted to describe to Dr. A how to use the ROC for biomarkers, so I made a brief Python tutorial for him to look at.  Below begins a more in-depth description of what I sent him.</p>
<p>We start by importing some necessary libraries:</p>
<pre><code class="language-python">%matplotlib inline
import matplotlib.pyplot as plt
from matplotlib.lines import Line2D

import numpy as np
from sklearn.metrics import auc
</code></pre>
<p>Next, we define a function to compute the ROC curve.  While 
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html" target="_blank" rel="noopener">scikit-learn</a> has a function to compute the ROC, computing it yourself makes it easier to understand what the ROC curve actually represents.</p>
<p>The ROC curve is essentially a curve that plots the true positive and false positive classification rates against one another, for various user-defined thresholds of the data.  We pick a biomarker level threshold &ndash; let&rsquo;s say $T$ &ndash; assign each sample a value of 0 or 1 depending on whether its measured biomarker level is greater than or less than $T$, and then compare these assignments to the <em>true</em> Case/Control classifications to compute the true and false positive rates.  We plots these rates for many $T$ to generate the ROC curve.</p>
<p>The ROC let&rsquo;s you look at how sensitive your model is to various parameterizations &ndash; are you able to accurately identify Cases from Controls?  How acceptable are misclassified results?  In this situation, we don&rsquo;t want to classify someone as healthy when in fact they might develop cardiotoxicity, so we want to allow some flexibility in terms of the number of false positives generated by our model &ndash; it&rsquo;s a classic case of &ldquo;better safe than sorry&rdquo;, since the &ldquo;sorry&rdquo; outcome might be an accidental patient death.</p>
<pre><code class="language-python">def roc(case, control, npoints, gte=True):
    
    &quot;&quot;&quot;
    Compute ROC curve for given set of Case/Control samples.
    
    Parameters:
    - - - - -
    case: float, array
        Samples from case patients
    control: float, array
        Samples from control patients
    npoints: int
        Number of TP/FP pairs to generate
    gte: boolean
        Whether control mean expected to be greater
        than case mean.

    Returns:
    - - - -
    specificity: float, array
        false positive rates
    sensitivity: float, array
        true positive rates
    &quot;&quot;&quot;

    # make sure generating more
    # than 1 TP/FP pair
    # so we can plot an actual ROC curve
    assert npoints &gt; 1
    

    # made sure case and control samples
    # are numpy arrays
    case = np.asarray(case)
    control = np.asarray(control)
    
    # check for NaN values
    # keep only indices without NaN
    case_nans = np.isnan(case)
    cont_nans = np.isnan(control)
    nans = (case_nans + cont_nans)
    
    specificity = []
    sensitivity = []
    
    # we'll define the min and max thresholds 
    # based on the min and max of our data
    conc = np.concatenate([case[~nans],control[~nans]])

    # function comparison map
    # use ```gte``` parameter
    # if we expect controls to be less than
    # cases, gte = False
    # otherwise gte = True
    comp_map = {'False': np.less,
                'True': np.greater}
    
    # generate npoints equally spaced threshold values
    # compute the false positive / true positive rates 
    # at each threshold
    for thresh in np.linspace(conc.min(), conc.max(), npoints):

        fp = (comp_map[gte](case[~nans], thresh)).mean()
        tn = 1-fp
        
        tp = (comp_map[gte](control[~nans], thresh)).mean()
        fn = 1-tp
        
        specificity.append(tn)
        sensitivity.append(tp)
    
    return [np.asarray(specificity), np.asarray(sensitivity)]
</code></pre>
<p>Next up, I generate 5 different datasets.  Each dataset corresponds to fake samples from a &ldquo;Control&rdquo; distribution, and a &ldquo;Case&rdquo; distribution &ndash; each is distributed according to a univariate Normal distribution.  The Control distribution remains the same in each scenario: $N(\mu = 10, \sigma = 1)$, but I change the $\mu_{Case}$ parameter of the Case distribution in each instance, such that $\mu_{Case} \in [5,6,7,8,9,10]$.</p>
<p>We plot the example datasets as follows, and then compute the ROC curves for each dataset.</p>
<pre><code class="language-python"># define unique means
m1 = np.arange(5,11)
samples = {}.fromkeys(m1)

# define control distribution (this stays the same across 
n2 = np.random.normal(loc=10, scale=1, size=2000)

fig, (ax) = plt.subplots(2, 3, figsize=(15, 6))

for i, ax in enumerate(fig.axes):

    n1 = np.random.normal(loc=m1[i], scale=1, size=2000)
    samples[m1[i]] = n1

    ax.hist(n1, 25, alpha=0.5, label='Case', density=True,)
    ax.hist(n2, 25, alpha=0.5, label='Control', density=True,)
    ax.set_title('Mean: {:}, Sigma: 1'.format(m1[i]), fontsize=15)
    ax.set_xlabel('Biomarker Measures Variable', fontsize=15)
    ax.set_ylabel('Density', fontsize=15)
    ax.legend()

plt.tight_layout()
</code></pre>





  
  











<figure id="figure-example-casecontrol-datasets">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/Example.Histograms_hu3fd4354cc4807317c36f9db23aa54a3a_131982_2000x2000_fit_q90_lanczos.jpg" data-caption="Example Case/Control datasets.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/Example.Histograms_hu3fd4354cc4807317c36f9db23aa54a3a_131982_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="1080" height="432">
</a>


  
  
  <figcaption>
    Example Case/Control datasets.
  </figcaption>


</figure>

<pre><code class="language-python">fig, (ax1) = plt.subplots(1, 1)
for mean, case_data in samples.items():

    [spec, sens] = roc(case_data, n2, 100, gte=True)
    A = auc(spec, sens)

    L = 'Mean: %i, AUC: %.3f' % (mean, A)
    plt.plot(1-np.asarray(spec), np.asarray(sens), label=L)
    plt.legend(bbox_to_anchor=(1.04,1), fontsize=15)
    plt.xlabel('1-Specificity', fontsize=15)
    plt.ylabel('Sensitivity', fontsize=15)

    plt.title('ROC for Varying Case Distributions', fontsize=15)
</code></pre>





  
  











<figure id="figure-roc-curves-for-example-datasets">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/Example.ROC.Curves_hub481d6f71bf7ebea89899b0a7048eba2_73909_2000x2000_fit_q90_lanczos.jpg" data-caption="ROC curves for example datasets.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/Example.ROC.Curves_hub481d6f71bf7ebea89899b0a7048eba2_73909_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="432">
</a>


  
  
  <figcaption>
    ROC curves for example datasets.
  </figcaption>


</figure>

<p>We see that, as the distributions become less separated, the ability to distinguish points from either distribution is diminished.  This is shown by 1) a flattening of the ROC curve towards the diagonal, along with 2) the integration of the ROC curve, which generates the AUC metric.  When the distributions are far apart (as when the $\mu_{Case} = 5$), it is quite easy for a simple model to distinguish points sampled from either distribution, meaning this hypothetical model has good diagnostic power.</p>
<h3 id="analyzing-synthetic-dose-response-curves">Analyzing Synthetic Dose-Response Curves</h3>
<p>We now analyze some synthetic data, generated to look like dose-response curves.  As a refresher, dose-response curves measure the behavior of some tissue cells in response to increasing levels of (generally) drugs.  The $x$-axis is the drug dose, measured in some concentration or volume, and the $y$-axis is generally some measure of cell death or survival, generally ranging from 0% to 100%.  The curves, however, look sigmoidal.  So let&rsquo;s first generate a function to create sigmoid curves.</p>
<pre><code class="language-python">def sigmoid(beta, intercept, x):
    
    &quot;&quot;&quot;
    Fake sigmoid function, takes in coefficient, shift, and dose values.
    
    Parameters:
    - - - - -
    beta: float
        slope
    intercept: float
        negative exponential intercept
    x: float, array
        data samples
        
    Returns:
    - - - -
    dose_response: float, array
        single-subject dose-response vector
        Between 0 and 1.
    &quot;&quot;&quot;
    
    dose_resonse =  1 / (1 + np.exp(-beta*x + intercept))
    
    return dose_resonse
</code></pre>
<p>Next, let&rsquo;s actually generate some synethetic data for a dataset of fake subjects.  I want to incorporate some variability into the Cases and Controls, so I&rsquo;ll sample the subject parameters from distributions.  In this case, for each subject, I&rsquo;ll sample the logistic curve slope coefficient from $Beta$ distributions, and the intercept from $Normal$ distributions.  We&rsquo;ll sample 1000 Cases, and 1000 Controls.</p>
<p>For the slopes, we have</p>
<p>$$
\begin{align}
\beta_{Control} &amp;\sim Beta(a=5, b=3) \
\beta_{Case} &amp;\sim Beta(a=10, b=2)
\end{align}
$$</p>
<p>and for the intercepts, we have</p>
<p>$$
\begin{align}
I_{Control} &amp;\sim Normal(\mu=0, \sigma=1) \
I_{Case} &amp;\sim Normal(\mu=4, \sigma=1)
\end{align}
$$</p>
<p>As such, the dose-response curve for individual, $k$, is generated as follows:</p>
<p>$$
dr_{k} = \frac{1}{1 + e^{-(\beta_{k}X + I_{k})}}
$$</p>
<p>where $\beta_{k}$ and $I_{k}$ are the slope and intercept values for the given subject.  These distributional parameterizations are arbitrary &ndash; I just wanted to be able to incorporate variability across subjects and groups.</p>
<p>Let&rsquo;s generate some random Case/Control dose-response data and plot the coefficient histograms:</p>
<pre><code class="language-python"># n cases and controls
S = 1000

# dictionary of slopes and intercept values for each subject
controls = {k: {'beta': None,
                'intercept': None} for k in np.arange(S)}
cases = {k: {'beta': None,
             'intercept': None} for k in np.arange(S)}

# get lists of betas and intercepts
beta_control = []
beta_case = []

intercept_control = []
intercept_case = []

for i in np.arange(S):

    controls[i]['beta'] = np.random.beta(a=5, b=3)
    controls[i]['intercept'] = np.random.normal(loc=0, scale=1)

    intercept_control.append(controls[i]['intercept'])
    beta_control.append(controls[i]['beta'])

    cases[i]['beta'] = np.random.beta(a=10, b=2)
    cases[i]['intercept'] = np.random.normal(loc=4, scale=1)

    intercept_case.append(cases[i]['intercept'])
    beta_case.append(cases[i]['beta'])
</code></pre>
<p>Intercept histograms look like two different $$Normal$$ distributions:</p>
<pre><code class="language-python">fig = plt.figure(figsize=(12, 8))
plt.hist(intercept_control, 50, color='r', alpha=0.5, density=True, label='Control');
plt.hist(intercept_case, 50, color='b', alpha=0.5, density=True, label='Case');
plt.ylabel('Density', fontsize=15);
plt.xlabel('Intercepts', fontsize=15);
plt.title('Intercepts Coefficients By Group', fontsize=15);
plt.legend(fontsize=15);
plt.tight_layout()
</code></pre>





  
  











<figure id="figure-intercept-distributions-for-synthetic-dose-response-curves">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Intercepts_hua52c747286aa8e02ed6e6f3f9284fd3e_50701_2000x2000_fit_q90_lanczos.jpg" data-caption="Intercept distributions for synthetic dose-response curves.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Intercepts_hua52c747286aa8e02ed6e6f3f9284fd3e_50701_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="576">
</a>


  
  
  <figcaption>
    Intercept distributions for synthetic dose-response curves.
  </figcaption>


</figure>

<p>Slope histograms look like two different $Beta$ distributions:</p>
<pre><code class="language-python">fig = plt.figure(figsize=(12, 8))
plt.hist(beta_control, 50, color='r', alpha=0.5, label='Control', density=True);
plt.hist(beta_case, 50, color='b', alpha=0.5, label='Case', density=True);
plt.ylabel('Density', fontsize=15);
plt.xlabel('Betas', fontsize=15);
plt.title('Slope Coefficients By Group', fontsize=15);
plt.legend(fontsize=15);
plt.tight_layout()
</code></pre>





  
  











<figure id="figure-slope-distributions-for-synthetic-dose-response-curves">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Slopes_hu1357c4832cc06dad7fe19891c932d38e_54436_2000x2000_fit_q90_lanczos.jpg" data-caption="Slope distributions for synthetic dose-response curves.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Slopes_hu1357c4832cc06dad7fe19891c932d38e_54436_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="576">
</a>


  
  
  <figcaption>
    Slope distributions for synthetic dose-response curves.
  </figcaption>


</figure>

<p>Now we&rsquo;ll generate some fake dose-response curves for each of the 1000 Controls, and 1000 Cases.  We&rsquo;ll plot a subset of these curves to visualize our cross-group curve variability.</p>
<pre><code class="language-python"># define synthetic dose range
doses = np.linspace(-15,15,500)
dose_min = doses.min()
shifted_dose = doses + np.abs(dose_min)

fig, (ax1) = plt.subplots(figsize=(12, 8))

ec50_control = []
ec50_case = []

for c in np.arange(S):

    control_sample = sigmoid(controls[c]['beta'], controls[c]['intercept'], doses)
    case_sample = sigmoid(cases[c]['beta'], cases[c]['intercept'], doses)

    ec50_control.append(shifted_dose[control_sample &lt; 0.5].max())
    ec50_case.append(shifted_dose[case_sample &lt; 0.5].max())

    if (c % 15) == 0:

        ax1.plot(shifted_dose, control_sample, c='r', linewidth=3, alpha=0.3)
        ax1.plot(shifted_dose, case_sample, c='b', linewidth=3, alpha=0.3)

plt.legend({})
plt.title('Dose Response Curve', fontsize=20);
plt.xlabel('Dose', fontsize=20);
plt.xticks(fontsize=15)
plt.ylabel('Response', fontsize=20);
plt.yticks(fontsize=15)

custom_lines = [Line2D([0], [0], color='r', lw=4),
                Line2D([0], [0], color='b', lw=4)]
plt.legend(custom_lines, ['Control', 'Case'], fontsize=20);
</code></pre>





  
  











<figure id="figure-casecontrol-dose-response-curves">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Curves_hube552fddd3db2e1c8078160f744ce767_111292_2000x2000_fit_q90_lanczos.jpg" data-caption="Case/Control dose-response curves.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.Curves_hube552fddd3db2e1c8078160f744ce767_111292_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="576">
</a>


  
  
  <figcaption>
    Case/Control dose-response curves.
  </figcaption>


</figure>

<p>For our preliminary biomarker of interest, let&rsquo;s look at the <strong>ec50</strong>, which is the dose at which <em>50%</em> of the cells show some response (i.e. where our $y$-axis = 0.5), for each sample in our dataset.  We&rsquo;ll plot these doses as a function of Cases and Controls.</p>
<pre><code class="language-python">fig = plt.figure(figsize=(12, 8))
plt.hist(ec50_control, 50, color='r', alpha=0.5, label='Control', density=True);
plt.hist(ec50_case, 50, color='b', alpha=0.5, label='Case', density=True);
plt.legend(fontsize=20);
plt.xlabel('ec50', fontsize=20);
plt.xticks(fontsize=15);
plt.ylabel('Density', fontsize=20);
plt.yticks(fontsize=15);
</code></pre>





  
  











<figure id="figure-biomarker-distributions-ec50-for-cases-and-controls">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.ec50_hu708c2993441f485c03fd9143c770b8b4_45795_2000x2000_fit_q90_lanczos.jpg" data-caption="Biomarker distributions: ec50 for Cases and Controls.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.ec50_hu708c2993441f485c03fd9143c770b8b4_45795_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="576">
</a>


  
  
  <figcaption>
    Biomarker distributions: ec50 for Cases and Controls.
  </figcaption>


</figure>

<p>If we select a different threshold &ndash; i.e. instead of 0.5, we can iterate over the range of 0.1 - 0.9, for example, in increments of 0.1 &ndash; we generate different biomarkers (ec10, ec20 &hellip; ec90).  We can treat each biomarker as a different classification model, and assess how powerful that model is at assessing whether someone will develop cardiotoxicity or not.  To do so, we&rsquo;ll create distributions for each biomarker (not shown), and then generate ROC curves and AUC values for each curve.</p>





  
  











<figure id="figure-roc-curves-and-auc-for-each-ec-x-biomarker-level">


  <a data-fancybox="" href="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.ecCurves.All_hu55950f119f4e6eab959a42f36f20836c_76398_2000x2000_fit_q90_lanczos.jpg" data-caption="ROC curves and AUC for each ec-X biomarker level.">


  <img data-src="/post/dose-response-curves-and-biomarker-diagnostic-power/DR.ecCurves.All_hu55950f119f4e6eab959a42f36f20836c_76398_2000x2000_fit_q90_lanczos.jpg" class="lazyload" alt="" width="864" height="576">
</a>


  
  
  <figcaption>
    ROC curves and AUC for each ec-X biomarker level.
  </figcaption>


</figure>

<p>This is where my limited domain knowledge comes at a cost &ndash; I&rsquo;m not sure if the biomarkers I&rsquo;ve chosen (i.e. incremental <strong>ec</strong> values) are actually biologically relevant.  The point, however, is that each biomarker yields a different AUC, which theoretically shows that the Cases and Controls can be differentially distinguished, depending on which biomarker we choose to examine.  In this case, <strong>ec10</strong> has the most discriminative diagnostic power.</p>
<p>Something I did wonder about while exploring this data was how dependent the ROC curves and AUC statistics are on sample size.  Previously, I&rsquo;d looked at rates of convergence of various estimators &ndash; the AUC should also theoretically show some convergence to a &ldquo;true&rdquo; value as $n$ increases &ndash; but I&rsquo;m not sure if it follows any sort of relevant distribution.  I imagine the AUC is domain-dependent, in that it depends on the distribution of the biomarker of interest?  Might be a good idea for another post&hellip;</p>
<p>Cheers.</p>

    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/dose-response-curves-and-biomarker-diagnostic-power/&amp;text=Dose-Response%20Curves%20and%20Biomarker%20Diagnostic%20Power" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/dose-response-curves-and-biomarker-diagnostic-power/&amp;t=Dose-Response%20Curves%20and%20Biomarker%20Diagnostic%20Power" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Dose-Response%20Curves%20and%20Biomarker%20Diagnostic%20Power&amp;body=/post/dose-response-curves-and-biomarker-diagnostic-power/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/dose-response-curves-and-biomarker-diagnostic-power/&amp;title=Dose-Response%20Curves%20and%20Biomarker%20Diagnostic%20Power" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/avatar_hu1d33f7c1c3956865c98823fdaf357458_38773_270x270_fill_q90_lanczos_center.jpg" alt="">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/"></a></h5>
        <h6 class="card-subtitle">Data Scientist</h6>
        
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:keschenb@uw.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/keschh" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/kristianeschenburg" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/kristianeschenburg/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  












  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.cd45a9c0bbdd3dfb1c126917c601c9f2.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
